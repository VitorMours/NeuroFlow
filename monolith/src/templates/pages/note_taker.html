{% extends "base.jinja" %}

{% block head %}
{{ super() }}
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
{% endblock %}

{% block subtitle %}- Note {{ note_uuid }}{% endblock %}

{% block sidebar %}
    {% include "sidebar.html" %}
    <div class="vr"></div>
{% endblock %}

{% block content %}
<section class="w-100 h-screen d-flex p-3">
    <article contenteditable="true" class="w-50 overflow-auto" id="content-note-taker">
        
    </article>
    
    <div class="vr mx-3"></div>

    <article class="flex-fill" id="preview-note-taker">
        
        <hr class="my-4"></hr>
    
        
    </article>
</section>
{% endblock %}

{% block javascript_pre_bundle %} /
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    // TODO: Ainda precisa corrijir esse javascript
    const text = document.getElementById("content-note-taker");
    const preview = document.getElementById("preview-note-taker");
    
    // Função para atualizar o preview
    function updatePreview() {
        // Usa innerHTML ou innerText dependendo do que você quer
        const content = text.innerHTML || text.innerText || "";
        preview.innerHTML = marked.parse(content);
    }
    
    // Atualizar no carregamento inicial
    updatePreview();
    
    // Atualizar quando houver mudanças
    text.addEventListener('input', updatePreview);
    text.addEventListener('keyup', updatePreview);
    text.addEventListener('paste', function(e) {
        // Espera a colagem ser concluída
        setTimeout(updatePreview, 10);
    });
    text.addEventListener('cut', updatePreview);
</script>
{% endblock %}